# Django 02

> - Model

## Model

- **웹 어플리케이션의 데이터를 구조화하고 조작하기 위한 도구** 
- 단일한 데이터에 대한 정보를 가짐
  - 사용자가 저장한느 데이터들의 필수적인 필드들과 동작들을 포함
- 저장된 데이터베이스의 구조
- 
- 일반적으로 각각의 model은 하나의 데이터베이스 테이블에 매핑 (**model != database**, model이 더 큰 개념)



## Database

- DB
  - 체계화된 데이터의 모임
- 쿼리
  - 데이터를 조회하기 위한 명령어 
  - 조건에 맞는 데이터를 추출하거나 조작하는 명령어

### Database의 기본 구조

1. 스키마 (Schema)

   - 데이터베이스에서 자료의 구조, 표현방법, 관계 등을 정의한 구조
   - `PK(primary key)` : 기본 키 (아래의 경우 id)

   |  id  | name | age  |     phone     |     email      |
   | :--: | :--: | :--: | :-----------: | :------------: |
   |  1   | lee  |  15  | 010-1234-5678 | lee@naver.com  |
   |  2   | kim  |  25  | 010-7473-1273 | kim@naver.com  |
   |  3   | park |  20  | 010-2881-3828 | park@naver.com |

   

2. 테이블(Table)

   - 필드 / 컬럼 / 속성  => 열
   - 레코드 / 행 / 튜플  => 행



## ORM

- `Object-Relational-Mapping` : 객체 지향 프로그래밍 언어를 사용하여 **호환되지 않는 유형의 시스템 간에 (Django-SQL) 데이터를 변환하는 프로그래밍 기술**
- 장점
  - SQL을 잘 알지 못해도 DB조작이 가능 
  - SQL의 절차적 접근이 아닌 객체 지향적 접근으로 높은 생산성
- 단점
  - ORM만으로 완전한 서비스를 구현하기 어려운 경우가 있음
- **현대 웹 프레임워크의 요점은 웹 개발의 속도를 높이는 것 (생산성)**
- **우리는 DB를 객체로 조작하기 위해, 서로 다른 시스템 간의 호환성을 위해 ORM을 사용한다**













## 생성되는 파일


- `__init__.py` : 개별요소에 패키지처럼 접근하게 해준다 
- `asgi.py` : 비공개 웹사이트와 연동 시 사용
- `settings.py`
- *`urls.py` : 사용자의 요청을 가장 먼저 맞닥뜨림 
- `wsgi.py` : 배포 시 사용
- `admins.py` : 관리파일
- `apps.py` 
- *`models.py` : MTV에서 `M`을 담당
- `tests.py` : 테스트 코드 작성
- *`views.py` : MTV에서 `V, 즉 중간관리자`의 역할 담당
- Template은 자동 생성되지 않음!!! 별도로 `templates` 폴더를 생성해서 만들어줘야 한다 이 때 이름은 반드시 `templates`여야한다.

## 웹사이트 동작 방식

![image-20210308093807222](C:\Users\leejo\AppData\Roaming\Typora\typora-user-images\image-20210308093807222.png)

> - 웹 브라우저 주소창에 URL 입력 후 엔터
> - URL을 이용해서 서버의 IP를 찾는다
> - IP를 이용해서 서버에 접속
> - URL에 해당하는 자료를 요청
> - 웹 어플리케이션이 URL을 해석해서 해당하는 코드가 동작
> - 코드의 동작 결과를 응답으로 돌려줌
> - 서버가 웹브라우저를 데이터로 보내줌
> - 웹 브라우저 응답받은 데이터를 화면에 표시 
> - JS(AJAX)

## Views.py

**view함수의 첫번째 인자는 반드시 `request`이다**



## Template

- 데이터 표현을 제어하는 도구이자 표현에 관련된 로직
- 사용하는 built-in system : `DTL, django template language`
  - 조건, 반복, 변수, 치환, 필터 등의 기능을 제공
  - 프로그래밍적 로직이 아니라 프레젠테이션을 표현하기 위한 것 
  - 파이썬과 문법구조가 비슷하지만 파이썬 프로그래밍이 실행되는 것은 아님 

### DTL syntax 

1. variable
   1. `{{ variable }}`
   2. render()를 사용하여 views.py에서 정의한 변수를 template 파일로 넘겨 사용
   3. `dot(.)`를 사용하여 변수 속성에 접근할 수 있음
   4. render()의 세번째 인자로 {'key' : 'value'}와 같이 딕셔너리 형태로  표현
2. Filters
   1. `{{ variable|filter }}`
   2. 표시할 변수를 수정할 때 사용
   3. chained가 가능하며 일부 필터는 인자를 받기도 함 
      1. `{{ variable|truncatewords:30 }}` : 변수를 30자까지만 잘라서 출력하겠다는 의미 
3. Tags
   1. `{{ %tag% }}`
   2. 출력 텍스트를 만들거나, 반복 또는 논리를 수행하여 제어 흐름을 만드는 등 변수보다 복잡한 일들을 수행
   3. 일부 태그는 시작과 종료 태그가 필요
4. Comments
   1. `{# lorem ipsum #}`
   2. django template에서 줄의 주석을 표현하기 위해 사용
   3. 한 줄 주석에만 사용할 수 있음

## 디자인 패턴 

개발 설계 상 발생하는 문제를 해결하기 위한 해결책 (디자이너, 프론트, 엔드를 분리)

MTV : Model(데이터베이스), Template(화면-프론트), View(계산, 처리-백엔드)



- 